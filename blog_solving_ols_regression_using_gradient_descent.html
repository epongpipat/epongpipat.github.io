<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Ekarin Eric Pongpipat, M.A." />


<title>Solving Ordinary Least Squares (OLS) Regression using Gradient Descent</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116039246-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116039246-1');
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("blog_solving_ols_regression_using_gradient_descent.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">

    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a class="navbar-brand" href="index.html"><span class="fas fa-terminal" aria-hidden="true"></span></a>
      <a class="navbar-brand" href="index.html"><img src="images/icons8-artificial-intelligence-100.png" style="height: 20px"></a>
      <a class="navbar-brand" href="index.html"><img src="images/icons8-scatter-plot-96.png" style="height: 20px"></a>
      <a class="navbar-brand" href="index.html">Ekarin Eric Pongpipat, M.A.</a>
    </div> <!-- /.navbar-header -->

    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="blog.html"><span class="fas fa-quote-left" aria-hidden="true"></span> &ensp;Blog</a></li>
         <li><a href="books.html"><span class="fas fa-book" aria-hidden="true"></span> &ensp;eBooks</a></li>
        <li><a href="CV.html"><span class="far fa-id-badge" aria-hidden="true"></span> &ensp;CV</a></li>
        <li><a href="https://github.com/epongpipat" target="_blank"><span class="fa fa-github" aria-hidden="true"></span> &ensp;GitHub</a></li>

        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="fas fa-handshake" aria-hidden="true"></span> &ensp;Connect<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="mailto:epongpipat@gmail.com" target="_blank"><span class="fa fa-envelope" aria-hidden="true"></span> &ensp;Email</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="https://twitter.com/epongpipat" target="_blank"><span class="fab fa-twitter" aria-hidden="true"></span> &ensp;Twitter</a></li>
            <li><a href="https://www.researchgate.net/profile/Ekarin_Pongpipat" target="_blank"><span class="fab fa-researchgate" aria-hidden="true"></span> &ensp;ResearchGate</a></li>
            <li><a href="https://www.linkedin.com/in/epongpipat/" target="_blank"><span class="fa fa-linkedin" aria-hidden="true"></span> &ensp;LinkedIn</a></li>
          </ul>
        </li>

      </ul>
    </div> <!-- /.navbar-collapse -->

  </div> <!-- /.container -->
</nav> <!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Solving Ordinary Least Squares (OLS) Regression using Gradient Descent</h1>
<h4 class="author">Ekarin Eric Pongpipat, M.A.</h4>

</div>


<p><font color="black">Original Post: 6/10/2019 <br>Modified Post: 6/17/2019</font></p>
<p><br></p>
<p>Already familiar with OLS regression and wanted to learn about gradient descent? This blog post will provide a brief tutorial on solving OLS using gradient descent using R.</p>
<p><br></p>
<p>Remember that the equation for OLS is:</p>
<p><span class="math display">\[
\tag{1}
Y = X\beta + \epsilon
\]</span></p>
<p>where <span class="math inline">\(Y\)</span> is a column-wise vector of DVs, <span class="math inline">\(X\)</span> is a matrix of IVs, <span class="math inline">\(\beta\)</span> is a column-wise vector of regression coefficients, and <span class="math inline">\(\epsilon\)</span> is a column-wise vector of error.</p>
<p><span class="math display">\[
\begin{bmatrix}
\tag{2}
y_1 \\
y_2 \\
. \\
. \\
. \\
y_n \\
\end{bmatrix} = 
\begin{bmatrix}
1 &amp; x_{1, 1} &amp; x_{1, 2} &amp; . &amp; . &amp; . &amp; x_{1, n} \\
1 &amp; x_{2, 1} &amp; x_{2, 2} &amp; . &amp; . &amp; . &amp; x_{2, n}\\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; .\\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; .\\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; .\\
1 &amp; x_{n, 1} &amp; x_{n, 2} &amp; . &amp; . &amp; . &amp; x_{n, n}\\
\end{bmatrix}
\begin{bmatrix}
b_0 \\
b_1 \\
. \\
. \\
. \\
b_n \\
\end{bmatrix} +
\begin{bmatrix}
e_1 \\
e_2 \\
. \\
. \\
. \\
e_n \\
\end{bmatrix}
\]</span></p>
<p>For a review of matrix multiplication, check out my <a href="blog_solving_ols_regression_using_matrix_algebra.html">previous blog post</a>.</p>
<p><br></p>
<p>OLS tries to minimize error using the mean squared error (MSE) formula:</p>
<p><span class="math display">\[
\tag{3}
MSE = \frac{\Sigma (Y-\hat{Y})^2}{N} = \frac{\Sigma e_i^2}{N} = mean(e_i^2)
\]</span></p>
<center>
where <span class="math inline">\(\hat{Y} = X\beta\)</span>
</center>
<p><br></p>
<p>Note: MSE is a single cost function (or formula) from many that we could choose from. For example, another cost function is mean absolute error (MAE):</p>
<p><span class="math display">\[
\tag{4}
MAE = \frac{\Sigma |Y-\hat{Y}|}{N} = \frac{\Sigma|e_i|}{N} = mean(abs(e_i))
\]</span></p>
<pre class="r"><code>obtain_cost &lt;- function(y, x, b) {
  y_pred &lt;- x %*% b
  e &lt;- y - y_pred
  se &lt;- e^2
  mse &lt;- mean(se)
  return(mse)
}</code></pre>
<p><br></p>
<blockquote>
<p>Let’s say that we are interested in understanding if the number of years a professor has had their Ph.D. is associated with a higher 9-month academic salary.</p>
</blockquote>
<p><br></p>
<div id="r-libraries" class="section level2">
<h2>R Libraries</h2>
<p>First, let’s load some packages.</p>
<pre class="r"><code>packages &lt;- c(&quot;tidyverse&quot;,   # data manipulation and visualization
              &quot;carData&quot;,     # data set to obtain professor&#39;s 9-month salary
              &quot;broom&quot;,       # nice table format of cofficients from lm()
              &quot;ggrepel&quot;,     # ggplot extension to repel text and extra features
              &quot;glue&quot;,        # concatentate strings and alias
              &quot;plot3D&quot;,      # plot 3D figures
              &quot;RColorBrewer&quot; # load color palettes
              )
xfun::pkg_attach(packages, message = F)
n_round &lt;- 3</code></pre>
<p><br></p>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>Then, let’s define our independent variable (IV: <code>yrs.since.phd</code>) as <code>x</code> and our dependent variable (DV: <code>salary</code>) as <code>y</code> using the <code>Salaries</code> dataset in the <code>carData</code> package.</p>
<pre class="r"><code>x &lt;- model.matrix(~ scale(yrs.since.phd, scale = F), Salaries)
colnames(x) &lt;- c(&quot;(Intercept)&quot;, &quot;yrs.since.phd&quot;)
dim(x)</code></pre>
<pre><code>## [1] 397   2</code></pre>
<pre class="r"><code>head(x)</code></pre>
<pre><code>##   (Intercept) yrs.since.phd
## 1           1         -3.31
## 2           1         -2.31
## 3           1        -18.31
## 4           1         22.69
## 5           1         17.69
## 6           1        -16.31</code></pre>
<pre class="r"><code>y &lt;- Salaries$salary %&gt;% as.matrix()
colnames(y) &lt;- c(&quot;salary&quot;)
dim(y)</code></pre>
<pre><code>## [1] 397   1</code></pre>
<pre class="r"><code>head(y)</code></pre>
<pre><code>##      salary
## [1,] 139750
## [2,] 173200
## [3,]  79750
## [4,] 115000
## [5,] 141500
## [6,]  97000</code></pre>
<p><br></p>
</div>
<div id="gradient-descent" class="section level2">
<h2>Gradient Descent</h2>
<p>What is gradient descent?</p>
<p>Starting at any position (e.g., intercept and slope combination), gradient descent takes the partial derivative of each coefficient (<span class="math inline">\(\beta\)</span>) from the cost function (MSE) and moves (or descends) in the direction that will continue to minimize the cost (or gradient) function.</p>
<pre class="r"><code># random sample of possible intercepts and slopes
# then calculate cost function (mse) for each intercept and slope combination
n_sample &lt;- 200000
df_gd &lt;- tibble(
  int = sample(seq(0, 200000), n_sample, T),
  slope = sample(seq(-10000, 10000), n_sample, T)
) %&gt;%
  rowwise() %&gt;%
  mutate(cost = obtain_cost(y, x, b = c(int, slope)))</code></pre>
<pre class="r"><code>scatter3D(x = df_gd$int,
          y = df_gd$slope,
          z = df_gd$cost,
          xlab = &quot;intercept&quot;,
          ylab = &quot;slope&quot;,
          zlab = &quot;cost (mse)&quot;,
          col = ramp.col(col = sort(RColorBrewer::brewer.pal(9, &quot;Blues&quot;), decreasing = F),
                         n = length(unique(df_gd$cost))),
          colkey = F,
          phi = 10,
          theta = 45,
          main = &quot;Gradient Descent (3D View)&quot;
          )</code></pre>
<p><img src="blog_solving_ols_regression_using_gradient_descent_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># plot intercept and slope, and color by cost (mse)
# highlight and label min(cost)
ggplot(df_gd, aes(slope, int, color = cost)) +
  geom_point() +
  geom_point(data = subset(df_gd, cost == min(cost)), color = &quot;black&quot;, shape = 21, alpha = .5) +
  geom_text_repel(
    data = subset(df_gd, cost == min(cost)),
    mapping = aes(label = paste0(&quot;min(cost) = &quot;, round(cost, n_round), &quot;\nintercept = &quot;, round(int, n_round), &quot;\nslope = &quot;, round(slope, n_round))),
    nudge_y = 30000,
    nudge_x = 1000,
    box.padding = 1.5,
    point.padding = 0.5,
    segment.size = 0.2,
    segment.color = &quot;black&quot;,
    color = &quot;black&quot;
  ) +
  labs(
    title = &quot;Gradient Descent (2D View)&quot;,
    y = &quot;intercept&quot;,
    color = &quot;cost (mse)&quot;
  ) +
  scale_color_distiller(palette = &quot;Blues&quot;) +
  theme_minimal()</code></pre>
<p><img src="blog_solving_ols_regression_using_gradient_descent_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We can see from these random samples of intercepts and slopes that the lowest cost is 754467038.308 with an intercept of 113693 and slope of 1019. So no matter where we start (any intercept and slope combination), we should descend and ultimately end up with the lowest cost value of 754467038.308.</p>
<p><br></p>
</div>
<div id="partial-derivatives" class="section level2">
<h2>Partial Derivatives</h2>
<p>What are partial derivatives?</p>
<p>Partial derivatives allow us to obtain a slope at any point that is specific to a variable on any function (or line). In our case, partial derivatives allow us to obtain a slope at any specific <span class="math inline">\(\beta\)</span> on the cost function of MSE, which can be denoted as <span class="math inline">\(\frac{\partial MSE}{\partial \hat{\beta}}\)</span>.</p>
<p><br></p>
<p>How do we calculate the partial derivatives?</p>
<p>First, we expand MSE.</p>
<p><span class="math display">\[ 
\tag{5}
\begin{align}
MSE &amp; = \frac{(Y-X\beta)^2}{N} \\
&amp; = \frac{(Y-X\beta)(Y-X\beta)}{N} \\
&amp; = \frac{(Y^2-2YX\beta+X^2\beta^2)}{N} \\
&amp; = \frac{Y^2}{N} - \frac{2YX\beta}{N}+\frac{X^2\beta^2}{N} \\
\end{align}
\]</span></p>
<p>To calculate the partial derivative, we repeat the following for each term:</p>
<ol style="list-style-type: decimal">
<li>Set the term without <span class="math inline">\(\beta\)</span> to 0</li>
<li>Multiply the term by the exponent of <span class="math inline">\(\beta\)</span></li>
<li>Subtract 1 from the exponent of <span class="math inline">\(\beta\)</span></li>
</ol>
<p>and simplify.</p>
<p><span class="math display">\[
\tag{6}
\begin{align}
\frac{\partial MSE}{\partial \hat{\beta}} &amp; = 0 - \frac{1*2YX\beta^0}{N} + \frac{2X^2\beta^1}{N} \\
&amp; = \frac{-2YX+2X^2\beta}{N} \\
&amp; = \frac{-2X(Y-X\beta)}{N} \\
&amp; = \frac{-2X\epsilon}{N}
\end{align}
\]</span> Note: We set the term without <span class="math inline">\(\beta\)</span> to 0 in step 1 because that term can be thought of as having <span class="math inline">\(\beta^0\)</span>, which equals 1. When we then multiply the term by the exponent of 0, we end up with a term of 0.</p>
<p><br></p>
</div>
<div id="update-coefficients" class="section level2">
<h2>Update Coefficients</h2>
<p>We can then use the information from partial derivatives to update the coefficients (<span class="math inline">\(\beta\)</span>) so that coefficients (<span class="math inline">\(\beta\)</span>) change and descend into a lower MSE.</p>
<p><br></p>
<p>How do we update the coefficients?</p>
<p>We can update the coefficients <span class="math inline">\(\beta\)</span> by subtracting the partial derivatives multiplied by the learning rate.</p>
<p><span class="math display">\[
\tag{7}
\hat{\beta} = \hat{\beta} - \frac{\partial MSE}{\partial \hat{\beta}}*learning\ rate
\]</span></p>
<p>A <span class="math inline">\(\beta\)</span> lower than it should be will have a negative slope and when we subtract the partial derivative (<span class="math inline">\(\frac{\partial MSE}{\partial \hat{\beta}}\)</span>) from the old <span class="math inline">\(\beta\)</span>, the new <span class="math inline">\(\beta\)</span> will then be less negative. Conversely, a <span class="math inline">\(\beta\)</span> higher than should be will have a positive slope and when we subtract the partial derivative (<span class="math inline">\(\frac{\partial MSE}{\partial \hat{\beta}}\)</span>), the new <span class="math inline">\(\beta\)</span> will be less positive. When we are at the lowest cost value, the partial derivative (<span class="math inline">\(\frac{\partial MSE}{\partial \hat{\beta}}\)</span>) will be 0 and <span class="math inline">\(\beta\)</span> will stop updating.</p>
<p><br></p>
<p>What is the learning rate?</p>
<p>The learning rate determines how fast the coefficients update (descends). A higher learning rate descends quickly but may be susceptible to skipping or moving past the global minima. A lower learning rate is more precise but is slower as it takes more time to compute.</p>
<pre class="r"><code>update_b &lt;- function(y, x, b, lr) {
  y_pred &lt;- x %*% b
  e &lt;- y - y_pred
  derivatives &lt;- (-2 * t(x) %*% e ) / nrow(x)
  b &lt;- b - derivatives * lr
  return(b)
}</code></pre>
<p><br></p>
</div>
<div id="train" class="section level2">
<h2>Train</h2>
<p>Now let’s train the data, arbitrarily starting the coefficients at 0 and a learning rate of 0.0001 for 50,000 iterations.</p>
<pre class="r"><code># set number of iterations
iter &lt;- 50000

# set learning rate
lr &lt;- 0.0001

# set initial values of coefficients
b &lt;- NULL
for (i in 1:ncol(x)) {
  b[i] &lt;- 0
}
b &lt;- as.matrix(b)

cat(paste(&quot;iteration&quot;, &quot;intercept&quot;, &quot;slope&quot;, &quot;cost\n&quot;, 
          &quot;0&quot;, round(b[1], n_round), round(b[2], n_round), round(obtain_cost(y, x, b), n_round)))</code></pre>
<pre><code>## iteration intercept slope cost
##  0 0 0 13844273659.244</code></pre>
<pre class="r"><code># set initial training dataset
df_train &lt;- tibble(
  iter = NA,
  int = NA,
  slope = NA,
  cost = NA,
  .rows = iter
)

# train and save training history using for loop
for (i in 1:iter) {
  b &lt;- update_b(y, x, b, lr)
  df_train$iter[i] &lt;- i
  df_train$int[i] &lt;- b[1]
  df_train$slope[i] &lt;- b[2]
  df_train$cost[i] &lt;- obtain_cost(y, x, b)
  if (i %in% round(seq(1, iter, length.out = 10), 0)) {
    cat(paste(&quot;\n&quot;, round(i, n_round), round(b[1], n_round), round(b[2], n_round), round(obtain_cost(y, x, b), n_round)))
  }
}</code></pre>
<pre><code>## 
##  1 22.741 32.646 13828621661.101
##  5556 76282.576 985.342 2154826164.687
##  11112 101389.243 985.342 905992994.67
##  16667 109651.717 985.342 770720117.435
##  22223 112371.933 985.342 756060150.645
##  27778 113267.142 985.342 754472191.632
##  33334 113561.867 985.342 754300099.289
##  38889 113658.86 985.342 754281458.348
##  44445 113690.793 985.342 754279438.168
##  50000 113701.301 985.342 754279219.343</code></pre>
<p><br></p>
<div id="plot-training" class="section level3">
<h3>Plot Training</h3>
<pre class="r"><code>ggplot(df_train, aes(iter, cost)) +
  geom_line() +
  theme_minimal() +
  labs(
    x = &quot;iterations&quot;,
    y = &quot;cost (mse)&quot;
  )</code></pre>
<p><img src="blog_solving_ols_regression_using_gradient_descent_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We can see that cost (MSE) flattens out around 15,000 iterations.</p>
<p><br></p>
</div>
<div id="plot-gradient-descent-path" class="section level3">
<h3>Plot Gradient Descent Path</h3>
<p>Let’s visualize the path that the gradient descent took, starting from our initial intercept and slope value of 0.</p>
<pre class="r"><code>n_sample &lt;- 100000
df_gd &lt;- tibble(
  int = sample(seq(0, 150000), n_sample, T),
  slope = sample(seq(0, 2000), n_sample, T)
) %&gt;%
  rowwise() %&gt;%
  mutate(cost = obtain_cost(y, x, b = c(int, slope)))

df_train_sorted &lt;- df_train %&gt;% arrange(cost, iter)
df_min &lt;- df_train_sorted[1, ]

ggplot(df_gd, aes(slope, int, color = cost)) +
  geom_point() +
  scale_color_distiller(palette = &quot;Blues&quot;) +
  theme_minimal() +
  labs(
    y = &quot;intercept&quot;,
    color = &quot;cost (mse)&quot;
  ) +
  geom_line(data = df_train, mapping = aes(slope, int), color = &quot;black&quot;, size = 0.5, alpha = 0.5) +
  geom_point(data = df_min, mapping = aes(slope, int), color = &quot;black&quot;, shape = 21, alpha = .5) +
  geom_text_repel(
    data = df_min,
    mapping = aes(label = paste0(&quot;min(cost) = &quot;, round(cost, n_round), &quot;\nintercept = &quot;, round(int, n_round), &quot;\nslope = &quot;, round(slope, n_round))),
    nudge_y = 30000,
    nudge_x = 1000,
    box.padding = 1.5,
    point.padding = 0.5,
    segment.size = 0.2,
    segment.color = &quot;black&quot;,
    color = &quot;black&quot;
  )</code></pre>
<p><img src="blog_solving_ols_regression_using_gradient_descent_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>We can see that most of the iterations were spent optimizing the slope with minimal changes to the intercept as well as the cost (MSE) up until around iteration 1000. Then, the optimal intercept was found within a few iterations, which dramatically reduced cost (MSE).</p>
<p><br></p>
</div>
</div>
<div id="compare-gradient-descent-and-lm" class="section level2">
<h2>Compare Gradient Descent and <code>lm()</code></h2>
<p>We can compare the results of gradient descent with <code>lm()</code> to ensure that we did this correctly. We should approximately have the same results within rounding error because OLS is a convex shape with only one global minima.</p>
<p><br></p>
<div id="solve-ols-using-gradient-descent" class="section level3">
<h3>Solve OLS using Gradient Descent</h3>
<pre class="r"><code>coef &lt;- c(&quot;(Intercept)&quot; = df_min$int, &quot;yrs.since.phd&quot; = df_min$slope)
rmse_coef &lt;- (solve(t(x) %*% x) * df_min$cost) %&gt;%
  diag() %&gt;%
  sqrt()
t_stat &lt;- coef / rmse_coef
n &lt;- nrow(x)
p &lt;- ncol(x)
df &lt;- n - p
p_value &lt;- 2 * pt(t_stat, df, lower = FALSE)
tibble(
  term = colnames(x),
  estimate = coef,
  std.error = rmse_coef,
  statistic = t_stat,
  p.value = p_value
)</code></pre>
<pre><code>## # A tibble: 2 x 5
##   term          estimate std.error statistic   p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    113701.     1378.     82.5  4.24e-251
## 2 yrs.since.phd     985.      107.      9.20 2.09e- 18</code></pre>
<p><br></p>
</div>
<div id="solve-ols-using-lm" class="section level3">
<h3>Solve OLS using <code>lm()</code></h3>
<pre class="r"><code>model &lt;- lm(y ~ x)
tidy(model)</code></pre>
<pre><code>## # A tibble: 2 x 5
##   term           estimate std.error statistic   p.value
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)     113706.     1382.     82.3  1.07e-250
## 2 xyrs.since.phd     985.      107.      9.18 2.50e- 18</code></pre>
<p><br></p>
</div>
<div id="cost" class="section level3">
<h3>Cost</h3>
<pre class="r"><code>glue(&quot;Cost using GD: {round(df_min$cost, n_round)}\nCost using lm(): {round(glance(model)$sigma^2, n_round)}&quot;)</code></pre>
<pre><code>## Cost using GD: 754279219.343
## Cost using lm(): 758098327.9</code></pre>
<p>We can see that solving OLS regression using gradient descent produced a lower cost function (MSE) than by using <code>lm()</code>. The lower MSE using gradient descent was produced from using a smaller intercept. Since MSE was smaller using gradient descent, the standard error was also smaller using gradient descent and subsequently a larger statistic and lower p-value.</p>
<p><br></p>
</div>
<div id="figure" class="section level3">
<h3>Figure</h3>
<pre class="r"><code>fig_gd &lt;- ggplot(mapping = aes(x[, 2], y)) +
  geom_point(alpha = 0.5) +
  geom_abline(intercept = coef[1], slope = coef[2], size = 1) +
  theme_minimal() +
  labs(
    title = &quot;Solved using Gradient Descent&quot;,
    x = &quot;yrs.since.phd&quot;,
    y = &quot;salary&quot;
  )

fig_lm &lt;- ggplot(mapping = aes(x[, 2], y)) +
  geom_point(alpha = 0.5) +
  geom_smooth(color = &quot;black&quot;, method = &quot;lm&quot;, se = F) +
  theme_minimal() +
  labs(
    title = &quot;Solved using lm()&quot;,
    x = &quot;yrs.since.phd&quot;,
    y = &quot;salary&quot;
  )

gridExtra::grid.arrange(fig_gd, fig_lm, nrow = 1)</code></pre>
<p><img src="blog_solving_ols_regression_using_gradient_descent_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>However, since the range of salary is so large, each method produced nearly identical graphs.</p>
<p><br></p>
</div>
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p><a href="https://ml-cheatsheet.readthedocs.io/en/latest/gradient_descent.html" target="_blank"><span class="citation">@bfortuner</span></a> for his gradient descent in python tutorial.</p>
<p><a href='https://github.com/mychan24' target='_blank'><span class="citation">@mychan24</span></a> for her helpful feedback and suggestions to this blog.</p>
<p><a href='https://github.com/praxling' target='_blank'><span class="citation">@praxling</span></a> for her proofing and feedback to this blog.</p>
<p><br></p>
<hr>
<p><br></p>
<!-- disqus START -->
<div id="disqus_thread">

</div>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = 'https://ekarinpongpipat.com/blog_solving_ols_regression_using_gradient_descent.html';  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'blog_solving_ols_regression_using_gradient_descent'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://epongpipat.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>
Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- disqus END -->
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiU29sdmluZyBPcmRpbmFyeSBMZWFzdCBTcXVhcmVzIChPTFMpIFJlZ3Jlc3Npb24gdXNpbmcgR3JhZGllbnQgRGVzY2VudCIKYXV0aG9yOiAiRWthcmluIEVyaWMgUG9uZ3BpcGF0LCBNLkEuIgpvdXRwdXQ6IAogIGh0bWxfZG9jdW1lbnQ6CiAgICBoaWdobGlnaHQ6IHRleHRtYXRlCiAgICB0aGVtZTogbHVtZW4KICAgIGNvZGVfZG93bmxvYWQ6IFRSVUUKICAgIGNvZGVfZm9sZGluZzogc2hvdwogICAgdG9jOiB5ZXMKICAgIHRvY19kZXB0aDogMwogICAgdG9jX2Zsb2F0OgogICAgICBjb2xsYXBzZWQ6IHllcwogICAgICBzbW9vdGhfc2Nyb2xsOiB5ZXMKLS0tCgo8Zm9udCBjb2xvcj0iYmxhY2siPk9yaWdpbmFsIFBvc3Q6IDYvMTAvMjAxOQo8YnI+TW9kaWZpZWQgUG9zdDogNi8xNy8yMDE5PC9mb250PgoKYGBge3IsIGluY2x1ZGU9Rn0Kb3B0aW9ucyhzY2lwZW4gPSA5OTksIGRpZ2l0cyA9IDMpCmBgYAoKPGJyPgoKQWxyZWFkeSBmYW1pbGlhciB3aXRoIE9MUyByZWdyZXNzaW9uIGFuZCB3YW50ZWQgdG8gbGVhcm4gYWJvdXQgZ3JhZGllbnQgZGVzY2VudD8gVGhpcyBibG9nIHBvc3Qgd2lsbCBwcm92aWRlIGEgYnJpZWYgdHV0b3JpYWwgb24gc29sdmluZyBPTFMgdXNpbmcgZ3JhZGllbnQgZGVzY2VudCB1c2luZyBSLgoKPGJyPgoKUmVtZW1iZXIgdGhhdCB0aGUgZXF1YXRpb24gZm9yIE9MUyBpczoKCiQkClx0YWd7MX0KWSA9IFhcYmV0YSArIFxlcHNpbG9uCiQkCgp3aGVyZSAkWSQgaXMgYSBjb2x1bW4td2lzZSB2ZWN0b3Igb2YgRFZzLCAkWCQgaXMgYSBtYXRyaXggb2YgSVZzLCAkXGJldGEkIGlzIGEgY29sdW1uLXdpc2UgdmVjdG9yIG9mIHJlZ3Jlc3Npb24gY29lZmZpY2llbnRzLCBhbmQgJFxlcHNpbG9uJCBpcyBhIGNvbHVtbi13aXNlIHZlY3RvciBvZiBlcnJvci4KCiQkClxiZWdpbntibWF0cml4fQpcdGFnezJ9CnlfMSBcXAp5XzIgXFwKLiBcXAouIFxcCi4gXFwKeV9uIFxcClxlbmR7Ym1hdHJpeH0gPSAKXGJlZ2lue2JtYXRyaXh9CjEgJiB4X3sxLCAxfSAmIHhfezEsIDJ9ICYgLiAmIC4gJiAuICYgeF97MSwgbn0gXFwKMSAmIHhfezIsIDF9ICYgeF97MiwgMn0gJiAuICYgLiAmIC4gJiB4X3syLCBufVxcCi4gJiAuICYgLiAmIC4gJiAuICYgLiAmIC5cXAouICYgLiAmIC4gJiAuICYgLiAmIC4gJiAuXFwKLiAmIC4gJiAuICYgLiAmIC4gJiAuICYgLlxcCjEgJiB4X3tuLCAxfSAmIHhfe24sIDJ9ICYgLiAmIC4gJiAuICYgeF97biwgbn1cXApcZW5ke2JtYXRyaXh9ClxiZWdpbntibWF0cml4fQpiXzAgXFwKYl8xIFxcCi4gXFwKLiBcXAouIFxcCmJfbiBcXApcZW5ke2JtYXRyaXh9ICsKXGJlZ2lue2JtYXRyaXh9CmVfMSBcXAplXzIgXFwKLiBcXAouIFxcCi4gXFwKZV9uIFxcClxlbmR7Ym1hdHJpeH0KJCQKCkZvciBhIHJldmlldyBvZiBtYXRyaXggbXVsdGlwbGljYXRpb24sIGNoZWNrIG91dCBteSBbcHJldmlvdXMgYmxvZyBwb3N0XShibG9nX3NvbHZpbmdfb2xzX3JlZ3Jlc3Npb25fdXNpbmdfbWF0cml4X2FsZ2VicmEuaHRtbCkuCgo8YnI+CgpPTFMgdHJpZXMgdG8gbWluaW1pemUgZXJyb3IgdXNpbmcgdGhlIG1lYW4gc3F1YXJlZCBlcnJvciAoTVNFKSBmb3JtdWxhOgoKJCQKXHRhZ3szfQpNU0UgPSBcZnJhY3tcU2lnbWEgKFktXGhhdHtZfSleMn17Tn0gPSBcZnJhY3tcU2lnbWEgZV9pXjJ9e059ID0gbWVhbihlX2leMikKJCQKCjxjZW50ZXI+d2hlcmUgJFxoYXR7WX0gPSBYXGJldGEkPC9jZW50ZXI+Cgo8YnI+CgpOb3RlOiBNU0UgaXMgYSBzaW5nbGUgY29zdCBmdW5jdGlvbiAob3IgZm9ybXVsYSkgZnJvbSBtYW55IHRoYXQgd2UgY291bGQgY2hvb3NlIGZyb20uIEZvciBleGFtcGxlLCBhbm90aGVyIGNvc3QgZnVuY3Rpb24gaXMgbWVhbiBhYnNvbHV0ZSBlcnJvciAoTUFFKTogCgokJApcdGFnezR9Ck1BRSA9IFxmcmFje1xTaWdtYSB8WS1caGF0e1l9fH17Tn0gPSBcZnJhY3tcU2lnbWF8ZV9pfH17Tn0gPSBtZWFuKGFicyhlX2kpKQokJAoKCmBgYHtyfQpvYnRhaW5fY29zdCA8LSBmdW5jdGlvbih5LCB4LCBiKSB7CiAgeV9wcmVkIDwtIHggJSolIGIKICBlIDwtIHkgLSB5X3ByZWQKICBzZSA8LSBlXjIKICBtc2UgPC0gbWVhbihzZSkKICByZXR1cm4obXNlKQp9CmBgYAoKPGJyPgoKPiBMZXQncyBzYXkgdGhhdCB3ZSBhcmUgaW50ZXJlc3RlZCBpbiB1bmRlcnN0YW5kaW5nIGlmIHRoZSBudW1iZXIgb2YgeWVhcnMgYSBwcm9mZXNzb3IgaGFzIGhhZCB0aGVpciBQaC5ELiBpcyBhc3NvY2lhdGVkIHdpdGggYSBoaWdoZXIgOS1tb250aCBhY2FkZW1pYyBzYWxhcnkuIAoKPGJyPgoKIyMgUiBMaWJyYXJpZXMKCkZpcnN0LCBsZXQncyBsb2FkIHNvbWUgcGFja2FnZXMuIAoKYGBge3J9CnBhY2thZ2VzIDwtIGMoInRpZHl2ZXJzZSIsICAgIyBkYXRhIG1hbmlwdWxhdGlvbiBhbmQgdmlzdWFsaXphdGlvbgogICAgICAgICAgICAgICJjYXJEYXRhIiwgICAgICMgZGF0YSBzZXQgdG8gb2J0YWluIHByb2Zlc3NvcidzIDktbW9udGggc2FsYXJ5CiAgICAgICAgICAgICAgImJyb29tIiwgICAgICAgIyBuaWNlIHRhYmxlIGZvcm1hdCBvZiBjb2ZmaWNpZW50cyBmcm9tIGxtKCkKICAgICAgICAgICAgICAiZ2dyZXBlbCIsICAgICAjIGdncGxvdCBleHRlbnNpb24gdG8gcmVwZWwgdGV4dCBhbmQgZXh0cmEgZmVhdHVyZXMKICAgICAgICAgICAgICAiZ2x1ZSIsICAgICAgICAjIGNvbmNhdGVudGF0ZSBzdHJpbmdzIGFuZCBhbGlhcwogICAgICAgICAgICAgICJwbG90M0QiLCAgICAgICMgcGxvdCAzRCBmaWd1cmVzCiAgICAgICAgICAgICAgIlJDb2xvckJyZXdlciIgIyBsb2FkIGNvbG9yIHBhbGV0dGVzCiAgICAgICAgICAgICAgKQp4ZnVuOjpwa2dfYXR0YWNoKHBhY2thZ2VzLCBtZXNzYWdlID0gRikKbl9yb3VuZCA8LSAzCmBgYAoKPGJyPgoKIyMgRGF0YQoKVGhlbiwgbGV0J3MgZGVmaW5lIG91ciBpbmRlcGVuZGVudCB2YXJpYWJsZSAoSVY6IGB5cnMuc2luY2UucGhkYCkgYXMgYHhgIGFuZCBvdXIgZGVwZW5kZW50IHZhcmlhYmxlICAoRFY6IGBzYWxhcnlgKSBhcyBgeWAgdXNpbmcgdGhlIGBTYWxhcmllc2AgZGF0YXNldCBpbiB0aGUgYGNhckRhdGFgIHBhY2thZ2UuCmBgYHtyfQp4IDwtIG1vZGVsLm1hdHJpeCh+IHNjYWxlKHlycy5zaW5jZS5waGQsIHNjYWxlID0gRiksIFNhbGFyaWVzKQpjb2xuYW1lcyh4KSA8LSBjKCIoSW50ZXJjZXB0KSIsICJ5cnMuc2luY2UucGhkIikKZGltKHgpCmhlYWQoeCkKeSA8LSBTYWxhcmllcyRzYWxhcnkgJT4lIGFzLm1hdHJpeCgpCmNvbG5hbWVzKHkpIDwtIGMoInNhbGFyeSIpCmRpbSh5KQpoZWFkKHkpCmBgYAoKPGJyPgoKIyMgR3JhZGllbnQgRGVzY2VudAoKV2hhdCBpcyBncmFkaWVudCBkZXNjZW50PwoKU3RhcnRpbmcgYXQgYW55IHBvc2l0aW9uIChlLmcuLCBpbnRlcmNlcHQgYW5kIHNsb3BlIGNvbWJpbmF0aW9uKSwgZ3JhZGllbnQgZGVzY2VudCB0YWtlcyB0aGUgcGFydGlhbCBkZXJpdmF0aXZlIG9mIGVhY2ggY29lZmZpY2llbnQgKCRcYmV0YSQpIGZyb20gdGhlIGNvc3QgZnVuY3Rpb24gKE1TRSkgYW5kIG1vdmVzIChvciBkZXNjZW5kcykgaW4gdGhlIGRpcmVjdGlvbiB0aGF0IHdpbGwgY29udGludWUgdG8gbWluaW1pemUgdGhlIGNvc3QgKG9yIGdyYWRpZW50KSBmdW5jdGlvbi4KCmBgYHtyfQojIHJhbmRvbSBzYW1wbGUgb2YgcG9zc2libGUgaW50ZXJjZXB0cyBhbmQgc2xvcGVzCiMgdGhlbiBjYWxjdWxhdGUgY29zdCBmdW5jdGlvbiAobXNlKSBmb3IgZWFjaCBpbnRlcmNlcHQgYW5kIHNsb3BlIGNvbWJpbmF0aW9uCm5fc2FtcGxlIDwtIDIwMDAwMApkZl9nZCA8LSB0aWJibGUoCiAgaW50ID0gc2FtcGxlKHNlcSgwLCAyMDAwMDApLCBuX3NhbXBsZSwgVCksCiAgc2xvcGUgPSBzYW1wbGUoc2VxKC0xMDAwMCwgMTAwMDApLCBuX3NhbXBsZSwgVCkKKSAlPiUKICByb3d3aXNlKCkgJT4lCiAgbXV0YXRlKGNvc3QgPSBvYnRhaW5fY29zdCh5LCB4LCBiID0gYyhpbnQsIHNsb3BlKSkpCmBgYAoKYGBge3J9CnNjYXR0ZXIzRCh4ID0gZGZfZ2QkaW50LAogICAgICAgICAgeSA9IGRmX2dkJHNsb3BlLAogICAgICAgICAgeiA9IGRmX2dkJGNvc3QsCiAgICAgICAgICB4bGFiID0gImludGVyY2VwdCIsCiAgICAgICAgICB5bGFiID0gInNsb3BlIiwKICAgICAgICAgIHpsYWIgPSAiY29zdCAobXNlKSIsCiAgICAgICAgICBjb2wgPSByYW1wLmNvbChjb2wgPSBzb3J0KFJDb2xvckJyZXdlcjo6YnJld2VyLnBhbCg5LCAiQmx1ZXMiKSwgZGVjcmVhc2luZyA9IEYpLAogICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGxlbmd0aCh1bmlxdWUoZGZfZ2QkY29zdCkpKSwKICAgICAgICAgIGNvbGtleSA9IEYsCiAgICAgICAgICBwaGkgPSAxMCwKICAgICAgICAgIHRoZXRhID0gNDUsCiAgICAgICAgICBtYWluID0gIkdyYWRpZW50IERlc2NlbnQgKDNEIFZpZXcpIgogICAgICAgICAgKQpgYGAKCmBgYHtyfQojIHBsb3QgaW50ZXJjZXB0IGFuZCBzbG9wZSwgYW5kIGNvbG9yIGJ5IGNvc3QgKG1zZSkKIyBoaWdobGlnaHQgYW5kIGxhYmVsIG1pbihjb3N0KQpnZ3Bsb3QoZGZfZ2QsIGFlcyhzbG9wZSwgaW50LCBjb2xvciA9IGNvc3QpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX3BvaW50KGRhdGEgPSBzdWJzZXQoZGZfZ2QsIGNvc3QgPT0gbWluKGNvc3QpKSwgY29sb3IgPSAiYmxhY2siLCBzaGFwZSA9IDIxLCBhbHBoYSA9IC41KSArCiAgZ2VvbV90ZXh0X3JlcGVsKAogICAgZGF0YSA9IHN1YnNldChkZl9nZCwgY29zdCA9PSBtaW4oY29zdCkpLAogICAgbWFwcGluZyA9IGFlcyhsYWJlbCA9IHBhc3RlMCgibWluKGNvc3QpID0gIiwgcm91bmQoY29zdCwgbl9yb3VuZCksICJcbmludGVyY2VwdCA9ICIsIHJvdW5kKGludCwgbl9yb3VuZCksICJcbnNsb3BlID0gIiwgcm91bmQoc2xvcGUsIG5fcm91bmQpKSksCiAgICBudWRnZV95ID0gMzAwMDAsCiAgICBudWRnZV94ID0gMTAwMCwKICAgIGJveC5wYWRkaW5nID0gMS41LAogICAgcG9pbnQucGFkZGluZyA9IDAuNSwKICAgIHNlZ21lbnQuc2l6ZSA9IDAuMiwKICAgIHNlZ21lbnQuY29sb3IgPSAiYmxhY2siLAogICAgY29sb3IgPSAiYmxhY2siCiAgKSArCiAgbGFicygKICAgIHRpdGxlID0gIkdyYWRpZW50IERlc2NlbnQgKDJEIFZpZXcpIiwKICAgIHkgPSAiaW50ZXJjZXB0IiwKICAgIGNvbG9yID0gImNvc3QgKG1zZSkiCiAgKSArCiAgc2NhbGVfY29sb3JfZGlzdGlsbGVyKHBhbGV0dGUgPSAiQmx1ZXMiKSArCiAgdGhlbWVfbWluaW1hbCgpCgpgYGAKCldlIGNhbiBzZWUgZnJvbSB0aGVzZSByYW5kb20gc2FtcGxlcyBvZiBpbnRlcmNlcHRzIGFuZCBzbG9wZXMgdGhhdCB0aGUgbG93ZXN0IGNvc3QgaXMgYHIgc3Vic2V0KGRmX2dkLCBjb3N0ID09IG1pbihjb3N0KSkkY29zdGAgd2l0aCBhbiBpbnRlcmNlcHQgb2YgYHIgc3Vic2V0KGRmX2dkLCBjb3N0ID09IG1pbihjb3N0KSkkaW50YCBhbmQgc2xvcGUgb2YgYHIgc3Vic2V0KGRmX2dkLCBjb3N0ID09IG1pbihjb3N0KSkkc2xvcGVgLiBTbyBubyBtYXR0ZXIgd2hlcmUgd2Ugc3RhcnQgKGFueSBpbnRlcmNlcHQgYW5kIHNsb3BlIGNvbWJpbmF0aW9uKSwgd2Ugc2hvdWxkIGRlc2NlbmQgYW5kIHVsdGltYXRlbHkgZW5kIHVwIHdpdGggdGhlIGxvd2VzdCBjb3N0IHZhbHVlIG9mIGByIHN1YnNldChkZl9nZCwgY29zdCA9PSBtaW4oY29zdCkpJGNvc3RgLgoKPGJyPgoKIyMgUGFydGlhbCBEZXJpdmF0aXZlcwoKV2hhdCBhcmUgcGFydGlhbCBkZXJpdmF0aXZlcz8KClBhcnRpYWwgZGVyaXZhdGl2ZXMgYWxsb3cgdXMgdG8gb2J0YWluIGEgc2xvcGUgYXQgYW55IHBvaW50IHRoYXQgaXMgc3BlY2lmaWMgdG8gYSB2YXJpYWJsZSBvbiBhbnkgZnVuY3Rpb24gKG9yIGxpbmUpLiBJbiBvdXIgY2FzZSwgcGFydGlhbCBkZXJpdmF0aXZlcyBhbGxvdyB1cyB0byBvYnRhaW4gYSBzbG9wZSBhdCBhbnkgc3BlY2lmaWMgJFxiZXRhJCBvbiB0aGUgY29zdCBmdW5jdGlvbiBvZiBNU0UsIHdoaWNoIGNhbiBiZSBkZW5vdGVkIGFzICRcZnJhY3tccGFydGlhbCBNU0V9e1xwYXJ0aWFsIFxoYXR7XGJldGF9fSQuIAoKPGJyPgoKSG93IGRvIHdlIGNhbGN1bGF0ZSB0aGUgcGFydGlhbCBkZXJpdmF0aXZlcz8KCkZpcnN0LCB3ZSBleHBhbmQgTVNFLgoKJCQgClx0YWd7NX0KXGJlZ2lue2FsaWdufQpNU0UgJiA9IFxmcmFjeyhZLVhcYmV0YSleMn17Tn0gXFwKJiA9IFxmcmFjeyhZLVhcYmV0YSkoWS1YXGJldGEpfXtOfSBcXAomID0gXGZyYWN7KFleMi0yWVhcYmV0YStYXjJcYmV0YV4yKX17Tn0gXFwKJiA9IFxmcmFje1leMn17Tn0gLSBcZnJhY3syWVhcYmV0YX17Tn0rXGZyYWN7WF4yXGJldGFeMn17Tn0gXFwKXGVuZHthbGlnbn0KJCQKClRvIGNhbGN1bGF0ZSB0aGUgcGFydGlhbCBkZXJpdmF0aXZlLCB3ZSByZXBlYXQgdGhlIGZvbGxvd2luZyBmb3IgZWFjaCB0ZXJtOgoKMS4gU2V0IHRoZSB0ZXJtIHdpdGhvdXQgJFxiZXRhJCB0byAwIAoyLiBNdWx0aXBseSB0aGUgdGVybSBieSB0aGUgZXhwb25lbnQgb2YgJFxiZXRhJAozLiBTdWJ0cmFjdCAxIGZyb20gdGhlIGV4cG9uZW50IG9mICRcYmV0YSQKCmFuZCBzaW1wbGlmeS4KCiQkClx0YWd7Nn0KXGJlZ2lue2FsaWdufQpcZnJhY3tccGFydGlhbCBNU0V9e1xwYXJ0aWFsIFxoYXR7XGJldGF9fSAmID0gMCAtIFxmcmFjezEqMllYXGJldGFeMH17Tn0gKyBcZnJhY3syWF4yXGJldGFeMX17Tn0gXFwKJiA9IFxmcmFjey0yWVgrMlheMlxiZXRhfXtOfSBcXAomID0gXGZyYWN7LTJYKFktWFxiZXRhKX17Tn0gXFwKJiA9IFxmcmFjey0yWFxlcHNpbG9ufXtOfQpcZW5ke2FsaWdufQokJApOb3RlOiBXZSBzZXQgdGhlIHRlcm0gd2l0aG91dCAkXGJldGEkIHRvIDAgaW4gc3RlcCAxIGJlY2F1c2UgdGhhdCB0ZXJtIGNhbiBiZSB0aG91Z2h0IG9mIGFzIGhhdmluZyAkXGJldGFeMCQsIHdoaWNoIGVxdWFscyAxLiBXaGVuIHdlIHRoZW4gbXVsdGlwbHkgdGhlIHRlcm0gYnkgdGhlIGV4cG9uZW50IG9mIDAsIHdlIGVuZCB1cCB3aXRoIGEgdGVybSBvZiAwLgoKPGJyPgoKIyMgVXBkYXRlIENvZWZmaWNpZW50cwoKV2UgY2FuIHRoZW4gdXNlIHRoZSBpbmZvcm1hdGlvbiBmcm9tIHBhcnRpYWwgZGVyaXZhdGl2ZXMgdG8gdXBkYXRlIHRoZSBjb2VmZmljaWVudHMgKCRcYmV0YSQpIHNvIHRoYXQgY29lZmZpY2llbnRzICgkXGJldGEkKSBjaGFuZ2UgYW5kIGRlc2NlbmQgaW50byBhIGxvd2VyIE1TRS4gCgo8YnI+CgpIb3cgZG8gd2UgdXBkYXRlIHRoZSBjb2VmZmljaWVudHM/CgpXZSBjYW4gdXBkYXRlIHRoZSBjb2VmZmljaWVudHMgJFxiZXRhJCBieSBzdWJ0cmFjdGluZyB0aGUgcGFydGlhbCBkZXJpdmF0aXZlcyBtdWx0aXBsaWVkIGJ5IHRoZSBsZWFybmluZyByYXRlLgoKJCQKXHRhZ3s3fQpcaGF0e1xiZXRhfSA9IFxoYXR7XGJldGF9IC0gXGZyYWN7XHBhcnRpYWwgTVNFfXtccGFydGlhbCBcaGF0e1xiZXRhfX0qbGVhcm5pbmdcIHJhdGUKJCQKCkEgJFxiZXRhJCBsb3dlciB0aGFuIGl0IHNob3VsZCBiZSB3aWxsIGhhdmUgYSBuZWdhdGl2ZSBzbG9wZSBhbmQgd2hlbiB3ZSBzdWJ0cmFjdCB0aGUgcGFydGlhbCBkZXJpdmF0aXZlICgkXGZyYWN7XHBhcnRpYWwgTVNFfXtccGFydGlhbCBcaGF0e1xiZXRhfX0kKSBmcm9tIHRoZSBvbGQgJFxiZXRhJCwgdGhlIG5ldyAkXGJldGEkIHdpbGwgdGhlbiBiZSBsZXNzIG5lZ2F0aXZlLiBDb252ZXJzZWx5LCBhICRcYmV0YSQgaGlnaGVyIHRoYW4gc2hvdWxkIGJlIHdpbGwgaGF2ZSBhIHBvc2l0aXZlIHNsb3BlIGFuZCB3aGVuIHdlIHN1YnRyYWN0IHRoZSBwYXJ0aWFsIGRlcml2YXRpdmUgKCRcZnJhY3tccGFydGlhbCBNU0V9e1xwYXJ0aWFsIFxoYXR7XGJldGF9fSQpLCB0aGUgbmV3ICRcYmV0YSQgd2lsbCBiZSBsZXNzIHBvc2l0aXZlLiBXaGVuIHdlIGFyZSBhdCB0aGUgbG93ZXN0IGNvc3QgdmFsdWUsIHRoZSBwYXJ0aWFsIGRlcml2YXRpdmUgKCRcZnJhY3tccGFydGlhbCBNU0V9e1xwYXJ0aWFsIFxoYXR7XGJldGF9fSQpIHdpbGwgYmUgMCBhbmQgJFxiZXRhJCB3aWxsIHN0b3AgdXBkYXRpbmcuCgo8YnI+CgpXaGF0IGlzIHRoZSBsZWFybmluZyByYXRlPwoKVGhlIGxlYXJuaW5nIHJhdGUgZGV0ZXJtaW5lcyBob3cgZmFzdCB0aGUgY29lZmZpY2llbnRzIHVwZGF0ZSAoZGVzY2VuZHMpLiBBIGhpZ2hlciBsZWFybmluZyByYXRlIGRlc2NlbmRzIHF1aWNrbHkgYnV0IG1heSBiZSBzdXNjZXB0aWJsZSB0byBza2lwcGluZyBvciBtb3ZpbmcgcGFzdCB0aGUgZ2xvYmFsIG1pbmltYS4gQSBsb3dlciBsZWFybmluZyByYXRlIGlzIG1vcmUgcHJlY2lzZSBidXQgaXMgc2xvd2VyIGFzIGl0IHRha2VzIG1vcmUgdGltZSB0byBjb21wdXRlLgoKYGBge3J9CnVwZGF0ZV9iIDwtIGZ1bmN0aW9uKHksIHgsIGIsIGxyKSB7CiAgeV9wcmVkIDwtIHggJSolIGIKICBlIDwtIHkgLSB5X3ByZWQKICBkZXJpdmF0aXZlcyA8LSAoLTIgKiB0KHgpICUqJSBlICkgLyBucm93KHgpCiAgYiA8LSBiIC0gZGVyaXZhdGl2ZXMgKiBscgogIHJldHVybihiKQp9CmBgYAoKPGJyPgoKIyMgVHJhaW4KCk5vdyBsZXQncyB0cmFpbiB0aGUgZGF0YSwgYXJiaXRyYXJpbHkgc3RhcnRpbmcgdGhlIGNvZWZmaWNpZW50cyBhdCAwIGFuZCBhIGxlYXJuaW5nIHJhdGUgb2YgMC4wMDAxIGZvciA1MCwwMDAgaXRlcmF0aW9ucy4KCmBgYHtyfQojIHNldCBudW1iZXIgb2YgaXRlcmF0aW9ucwppdGVyIDwtIDUwMDAwCgojIHNldCBsZWFybmluZyByYXRlCmxyIDwtIDAuMDAwMQoKIyBzZXQgaW5pdGlhbCB2YWx1ZXMgb2YgY29lZmZpY2llbnRzCmIgPC0gTlVMTApmb3IgKGkgaW4gMTpuY29sKHgpKSB7CiAgYltpXSA8LSAwCn0KYiA8LSBhcy5tYXRyaXgoYikKCmNhdChwYXN0ZSgiaXRlcmF0aW9uIiwgImludGVyY2VwdCIsICJzbG9wZSIsICJjb3N0XG4iLCAKICAgICAgICAgICIwIiwgcm91bmQoYlsxXSwgbl9yb3VuZCksIHJvdW5kKGJbMl0sIG5fcm91bmQpLCByb3VuZChvYnRhaW5fY29zdCh5LCB4LCBiKSwgbl9yb3VuZCkpKQoKIyBzZXQgaW5pdGlhbCB0cmFpbmluZyBkYXRhc2V0CmRmX3RyYWluIDwtIHRpYmJsZSgKICBpdGVyID0gTkEsCiAgaW50ID0gTkEsCiAgc2xvcGUgPSBOQSwKICBjb3N0ID0gTkEsCiAgLnJvd3MgPSBpdGVyCikKCiMgdHJhaW4gYW5kIHNhdmUgdHJhaW5pbmcgaGlzdG9yeSB1c2luZyBmb3IgbG9vcApmb3IgKGkgaW4gMTppdGVyKSB7CiAgYiA8LSB1cGRhdGVfYih5LCB4LCBiLCBscikKICBkZl90cmFpbiRpdGVyW2ldIDwtIGkKICBkZl90cmFpbiRpbnRbaV0gPC0gYlsxXQogIGRmX3RyYWluJHNsb3BlW2ldIDwtIGJbMl0KICBkZl90cmFpbiRjb3N0W2ldIDwtIG9idGFpbl9jb3N0KHksIHgsIGIpCiAgaWYgKGkgJWluJSByb3VuZChzZXEoMSwgaXRlciwgbGVuZ3RoLm91dCA9IDEwKSwgMCkpIHsKICAgIGNhdChwYXN0ZSgiXG4iLCByb3VuZChpLCBuX3JvdW5kKSwgcm91bmQoYlsxXSwgbl9yb3VuZCksIHJvdW5kKGJbMl0sIG5fcm91bmQpLCByb3VuZChvYnRhaW5fY29zdCh5LCB4LCBiKSwgbl9yb3VuZCkpKQogIH0KfQpgYGAKCjxicj4KCiMjIyBQbG90IFRyYWluaW5nCgpgYGB7cn0KZ2dwbG90KGRmX3RyYWluLCBhZXMoaXRlciwgY29zdCkpICsKICBnZW9tX2xpbmUoKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICBsYWJzKAogICAgeCA9ICJpdGVyYXRpb25zIiwKICAgIHkgPSAiY29zdCAobXNlKSIKICApCmBgYAoKV2UgY2FuIHNlZSB0aGF0IGNvc3QgKE1TRSkgZmxhdHRlbnMgb3V0IGFyb3VuZCAxNSwwMDAgaXRlcmF0aW9ucy4gCgo8YnI+CgojIyMgUGxvdCBHcmFkaWVudCBEZXNjZW50IFBhdGgKCkxldCdzIHZpc3VhbGl6ZSB0aGUgcGF0aCB0aGF0IHRoZSBncmFkaWVudCBkZXNjZW50IHRvb2ssIHN0YXJ0aW5nIGZyb20gb3VyIGluaXRpYWwgaW50ZXJjZXB0IGFuZCBzbG9wZSB2YWx1ZSBvZiAwLgoKYGBge3J9Cm5fc2FtcGxlIDwtIDEwMDAwMApkZl9nZCA8LSB0aWJibGUoCiAgaW50ID0gc2FtcGxlKHNlcSgwLCAxNTAwMDApLCBuX3NhbXBsZSwgVCksCiAgc2xvcGUgPSBzYW1wbGUoc2VxKDAsIDIwMDApLCBuX3NhbXBsZSwgVCkKKSAlPiUKICByb3d3aXNlKCkgJT4lCiAgbXV0YXRlKGNvc3QgPSBvYnRhaW5fY29zdCh5LCB4LCBiID0gYyhpbnQsIHNsb3BlKSkpCgpkZl90cmFpbl9zb3J0ZWQgPC0gZGZfdHJhaW4gJT4lIGFycmFuZ2UoY29zdCwgaXRlcikKZGZfbWluIDwtIGRmX3RyYWluX3NvcnRlZFsxLCBdCgpnZ3Bsb3QoZGZfZ2QsIGFlcyhzbG9wZSwgaW50LCBjb2xvciA9IGNvc3QpKSArCiAgZ2VvbV9wb2ludCgpICsKICBzY2FsZV9jb2xvcl9kaXN0aWxsZXIocGFsZXR0ZSA9ICJCbHVlcyIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIGxhYnMoCiAgICB5ID0gImludGVyY2VwdCIsCiAgICBjb2xvciA9ICJjb3N0IChtc2UpIgogICkgKwogIGdlb21fbGluZShkYXRhID0gZGZfdHJhaW4sIG1hcHBpbmcgPSBhZXMoc2xvcGUsIGludCksIGNvbG9yID0gImJsYWNrIiwgc2l6ZSA9IDAuNSwgYWxwaGEgPSAwLjUpICsKICBnZW9tX3BvaW50KGRhdGEgPSBkZl9taW4sIG1hcHBpbmcgPSBhZXMoc2xvcGUsIGludCksIGNvbG9yID0gImJsYWNrIiwgc2hhcGUgPSAyMSwgYWxwaGEgPSAuNSkgKwogIGdlb21fdGV4dF9yZXBlbCgKICAgIGRhdGEgPSBkZl9taW4sCiAgICBtYXBwaW5nID0gYWVzKGxhYmVsID0gcGFzdGUwKCJtaW4oY29zdCkgPSAiLCByb3VuZChjb3N0LCBuX3JvdW5kKSwgIlxuaW50ZXJjZXB0ID0gIiwgcm91bmQoaW50LCBuX3JvdW5kKSwgIlxuc2xvcGUgPSAiLCByb3VuZChzbG9wZSwgbl9yb3VuZCkpKSwKICAgIG51ZGdlX3kgPSAzMDAwMCwKICAgIG51ZGdlX3ggPSAxMDAwLAogICAgYm94LnBhZGRpbmcgPSAxLjUsCiAgICBwb2ludC5wYWRkaW5nID0gMC41LAogICAgc2VnbWVudC5zaXplID0gMC4yLAogICAgc2VnbWVudC5jb2xvciA9ICJibGFjayIsCiAgICBjb2xvciA9ICJibGFjayIKICApCmBgYAoKV2UgY2FuIHNlZSB0aGF0IG1vc3Qgb2YgdGhlIGl0ZXJhdGlvbnMgd2VyZSBzcGVudCBvcHRpbWl6aW5nIHRoZSBzbG9wZSB3aXRoIG1pbmltYWwgY2hhbmdlcyB0byB0aGUgaW50ZXJjZXB0IGFzIHdlbGwgYXMgdGhlIGNvc3QgKE1TRSkgdXAgdW50aWwgYXJvdW5kIGl0ZXJhdGlvbiAxMDAwLiBUaGVuLCB0aGUgb3B0aW1hbCBpbnRlcmNlcHQgd2FzIGZvdW5kIHdpdGhpbiBhIGZldyBpdGVyYXRpb25zLCB3aGljaCBkcmFtYXRpY2FsbHkgcmVkdWNlZCBjb3N0IChNU0UpLgoKPGJyPgoKIyMgQ29tcGFyZSBHcmFkaWVudCBEZXNjZW50IGFuZCBgbG0oKWAKCldlIGNhbiBjb21wYXJlIHRoZSByZXN1bHRzIG9mIGdyYWRpZW50IGRlc2NlbnQgd2l0aCBgbG0oKWAgdG8gZW5zdXJlIHRoYXQgd2UgZGlkIHRoaXMgY29ycmVjdGx5LiBXZSBzaG91bGQgYXBwcm94aW1hdGVseSBoYXZlIHRoZSBzYW1lIHJlc3VsdHMgd2l0aGluIHJvdW5kaW5nIGVycm9yIGJlY2F1c2UgT0xTIGlzIGEgY29udmV4IHNoYXBlIHdpdGggb25seSBvbmUgZ2xvYmFsIG1pbmltYS4KCjxicj4KCiMjIyBTb2x2ZSBPTFMgdXNpbmcgR3JhZGllbnQgRGVzY2VudApgYGB7cn0KY29lZiA8LSBjKCIoSW50ZXJjZXB0KSIgPSBkZl9taW4kaW50LCAieXJzLnNpbmNlLnBoZCIgPSBkZl9taW4kc2xvcGUpCnJtc2VfY29lZiA8LSAoc29sdmUodCh4KSAlKiUgeCkgKiBkZl9taW4kY29zdCkgJT4lCiAgZGlhZygpICU+JQogIHNxcnQoKQp0X3N0YXQgPC0gY29lZiAvIHJtc2VfY29lZgpuIDwtIG5yb3coeCkKcCA8LSBuY29sKHgpCmRmIDwtIG4gLSBwCnBfdmFsdWUgPC0gMiAqIHB0KHRfc3RhdCwgZGYsIGxvd2VyID0gRkFMU0UpCnRpYmJsZSgKICB0ZXJtID0gY29sbmFtZXMoeCksCiAgZXN0aW1hdGUgPSBjb2VmLAogIHN0ZC5lcnJvciA9IHJtc2VfY29lZiwKICBzdGF0aXN0aWMgPSB0X3N0YXQsCiAgcC52YWx1ZSA9IHBfdmFsdWUKKQpgYGAKCjxicj4KCiMjIyBTb2x2ZSBPTFMgdXNpbmcgYGxtKClgCmBgYHtyfQptb2RlbCA8LSBsbSh5IH4geCkKdGlkeShtb2RlbCkKYGBgCgo8YnI+CgojIyMgQ29zdApgYGB7cn0KZ2x1ZSgiQ29zdCB1c2luZyBHRDoge3JvdW5kKGRmX21pbiRjb3N0LCBuX3JvdW5kKX1cbkNvc3QgdXNpbmcgbG0oKToge3JvdW5kKGdsYW5jZShtb2RlbCkkc2lnbWFeMiwgbl9yb3VuZCl9IikKYGBgCgpXZSBjYW4gc2VlIHRoYXQgc29sdmluZyBPTFMgcmVncmVzc2lvbiB1c2luZyBncmFkaWVudCBkZXNjZW50IHByb2R1Y2VkIGEgbG93ZXIgY29zdCBmdW5jdGlvbiAoTVNFKSB0aGFuIGJ5IHVzaW5nIGBsbSgpYC4gVGhlIGxvd2VyIE1TRSB1c2luZyBncmFkaWVudCBkZXNjZW50IHdhcyBwcm9kdWNlZCBmcm9tIHVzaW5nIGEgc21hbGxlciBpbnRlcmNlcHQuIFNpbmNlIE1TRSB3YXMgc21hbGxlciB1c2luZyBncmFkaWVudCBkZXNjZW50LCB0aGUgc3RhbmRhcmQgZXJyb3Igd2FzIGFsc28gc21hbGxlciB1c2luZyBncmFkaWVudCBkZXNjZW50IGFuZCBzdWJzZXF1ZW50bHkgYSBsYXJnZXIgc3RhdGlzdGljIGFuZCBsb3dlciBwLXZhbHVlLgoKPGJyPgoKIyMjIEZpZ3VyZQpgYGB7cn0KZmlnX2dkIDwtIGdncGxvdChtYXBwaW5nID0gYWVzKHhbLCAyXSwgeSkpICsKICBnZW9tX3BvaW50KGFscGhhID0gMC41KSArCiAgZ2VvbV9hYmxpbmUoaW50ZXJjZXB0ID0gY29lZlsxXSwgc2xvcGUgPSBjb2VmWzJdLCBzaXplID0gMSkgKwogIHRoZW1lX21pbmltYWwoKSArCiAgbGFicygKICAgIHRpdGxlID0gIlNvbHZlZCB1c2luZyBHcmFkaWVudCBEZXNjZW50IiwKICAgIHggPSAieXJzLnNpbmNlLnBoZCIsCiAgICB5ID0gInNhbGFyeSIKICApCgpmaWdfbG0gPC0gZ2dwbG90KG1hcHBpbmcgPSBhZXMoeFssIDJdLCB5KSkgKwogIGdlb21fcG9pbnQoYWxwaGEgPSAwLjUpICsKICBnZW9tX3Ntb290aChjb2xvciA9ICJibGFjayIsIG1ldGhvZCA9ICJsbSIsIHNlID0gRikgKwogIHRoZW1lX21pbmltYWwoKSArCiAgbGFicygKICAgIHRpdGxlID0gIlNvbHZlZCB1c2luZyBsbSgpIiwKICAgIHggPSAieXJzLnNpbmNlLnBoZCIsCiAgICB5ID0gInNhbGFyeSIKICApCgpncmlkRXh0cmE6OmdyaWQuYXJyYW5nZShmaWdfZ2QsIGZpZ19sbSwgbnJvdyA9IDEpCmBgYAoKSG93ZXZlciwgc2luY2UgdGhlIHJhbmdlIG9mIHNhbGFyeSBpcyBzbyBsYXJnZSwgZWFjaCBtZXRob2QgcHJvZHVjZWQgbmVhcmx5IGlkZW50aWNhbCBncmFwaHMuCgo8YnI+CgojIyBBY2tub3dsZWRnZW1lbnRzCgo8YSBocmVmPSJodHRwczovL21sLWNoZWF0c2hlZXQucmVhZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L2dyYWRpZW50X2Rlc2NlbnQuaHRtbCIgdGFyZ2V0PSJfYmxhbmsiPkBiZm9ydHVuZXI8L2E+IGZvciBoaXMgZ3JhZGllbnQgZGVzY2VudCBpbiBweXRob24gdHV0b3JpYWwuCgo8YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vbXljaGFuMjQnIHRhcmdldD0nX2JsYW5rJz5AbXljaGFuMjQ8L2E+IGZvciBoZXIgaGVscGZ1bCBmZWVkYmFjayBhbmQgc3VnZ2VzdGlvbnMgdG8gdGhpcyBibG9nLgoKPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL3ByYXhsaW5nJyB0YXJnZXQ9J19ibGFuayc+QHByYXhsaW5nPC9hPiBmb3IgaGVyIHByb29maW5nIGFuZCBmZWVkYmFjayB0byB0aGlzIGJsb2cuCgo8YnI+Cgo8aHI+Cgo8YnI+Cgo8IS0tIGRpc3F1cyBTVEFSVCAtLT4KPGRpdiBpZD0iZGlzcXVzX3RocmVhZCI+PC9kaXY+CjxzY3JpcHQ+Ci8qKgoqICBSRUNPTU1FTkRFRCBDT05GSUdVUkFUSU9OIFZBUklBQkxFUzogRURJVCBBTkQgVU5DT01NRU5UIFRIRSBTRUNUSU9OIEJFTE9XIFRPIElOU0VSVCBEWU5BTUlDIFZBTFVFUyBGUk9NIFlPVVIgUExBVEZPUk0gT1IgQ01TLgoqICBMRUFSTiBXSFkgREVGSU5JTkcgVEhFU0UgVkFSSUFCTEVTIElTIElNUE9SVEFOVDogaHR0cHM6Ly9kaXNxdXMuY29tL2FkbWluL3VuaXZlcnNhbGNvZGUvI2NvbmZpZ3VyYXRpb24tdmFyaWFibGVzKi8KLyoKdmFyIGRpc3F1c19jb25maWcgPSBmdW5jdGlvbiAoKSB7CnRoaXMucGFnZS51cmwgPSAnaHR0cHM6Ly9la2FyaW5wb25ncGlwYXQuY29tL2Jsb2dfc29sdmluZ19vbHNfcmVncmVzc2lvbl91c2luZ19ncmFkaWVudF9kZXNjZW50Lmh0bWwnOyAgLy8gUmVwbGFjZSBQQUdFX1VSTCB3aXRoIHlvdXIgcGFnZSdzIGNhbm9uaWNhbCBVUkwgdmFyaWFibGUKdGhpcy5wYWdlLmlkZW50aWZpZXIgPSAnYmxvZ19zb2x2aW5nX29sc19yZWdyZXNzaW9uX3VzaW5nX2dyYWRpZW50X2Rlc2NlbnQnOyAvLyBSZXBsYWNlIFBBR0VfSURFTlRJRklFUiB3aXRoIHlvdXIgcGFnZSdzIHVuaXF1ZSBpZGVudGlmaWVyIHZhcmlhYmxlCn07CiovCihmdW5jdGlvbigpIHsgLy8gRE9OJ1QgRURJVCBCRUxPVyBUSElTIExJTkUKdmFyIGQgPSBkb2N1bWVudCwgcyA9IGQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CnMuc3JjID0gJ2h0dHBzOi8vZXBvbmdwaXBhdC5kaXNxdXMuY29tL2VtYmVkLmpzJzsKcy5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGltZXN0YW1wJywgK25ldyBEYXRlKCkpOwooZC5oZWFkIHx8IGQuYm9keSkuYXBwZW5kQ2hpbGQocyk7Cn0pKCk7Cjwvc2NyaXB0Pgo8bm9zY3JpcHQ+UGxlYXNlIGVuYWJsZSBKYXZhU2NyaXB0IHRvIHZpZXcgdGhlIDxhIGhyZWY9Imh0dHBzOi8vZGlzcXVzLmNvbS8/cmVmX25vc2NyaXB0Ij5jb21tZW50cyBwb3dlcmVkIGJ5IERpc3F1cy48L2E+PC9ub3NjcmlwdD4KPCEtLSBkaXNxdXMgRU5EIC0tPg==</div>
</div>
</div>
</div>
<div class="footer" style="red">
  <hr style="solid 1px">
  &copy; 2019 Ekarin Eric Pongpipat. <a href="https://raw.githubusercontent.com/epongpipat/epongpipat.github.io/master/LICENSE" target="_blank">All rights reserved.</a>
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
